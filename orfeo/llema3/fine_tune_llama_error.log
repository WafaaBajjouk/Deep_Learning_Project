Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:14,  4.98s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.99s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.94s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:16<00:00,  3.47s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:16<00:00,  4.02s/it]
/u/dssc/wbajjouk/.local/lib/python3.9/site-packages/huggingface_hub/utils/_deprecation.py:100: FutureWarning: Deprecated argument(s) used in '__init__': dataset_text_field. Will not be supported from version '1.0.0'.

Deprecated positional argument(s) used in SFTTrainer, please use the SFTConfig to set these arguments instead.
  warnings.warn(message, FutureWarning)
/u/dssc/wbajjouk/.local/lib/python3.9/site-packages/trl/trainer/sft_trainer.py:292: UserWarning: You didn't pass a `max_seq_length` argument to the SFTTrainer, this will default to 1024
  warnings.warn(
/u/dssc/wbajjouk/.local/lib/python3.9/site-packages/trl/trainer/sft_trainer.py:321: UserWarning: You passed a `dataset_text_field` argument to the SFTTrainer, the value you passed will override the one in the `SFTConfig`.
  warnings.warn(
Map:   0%|          | 0/26216 [00:00<?, ? examples/s]Map:  15%|█▌        | 4000/26216 [00:00<00:00, 23203.14 examples/s]Map:  31%|███       | 8000/26216 [00:00<00:00, 24059.90 examples/s]Map:  46%|████▌     | 12000/26216 [00:00<00:00, 24437.92 examples/s]Map:  61%|██████    | 16000/26216 [00:00<00:00, 24715.01 examples/s]Map:  76%|███████▋  | 20000/26216 [00:00<00:00, 24839.29 examples/s]Map:  88%|████████▊ | 23000/26216 [00:01<00:00, 19289.47 examples/s]Map: 100%|██████████| 26216/26216 [00:01<00:00, 20445.91 examples/s]Map: 100%|██████████| 26216/26216 [00:01<00:00, 21441.75 examples/s]
/u/dssc/wbajjouk/.local/lib/python3.9/site-packages/accelerate/accelerator.py:494: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  self.scaler = torch.cuda.amp.GradScaler(**kwargs)
max_steps is given, it will override any value given in num_train_epochs
  0%|          | 0/250 [00:00<?, ?it/s]  0%|          | 1/250 [00:11<46:40, 11.25s/it]  1%|          | 2/250 [00:21<43:06, 10.43s/it]  1%|          | 3/250 [00:30<41:48, 10.16s/it]  2%|▏         | 4/250 [00:40<41:06, 10.03s/it]  2%|▏         | 5/250 [00:50<40:38,  9.95s/it]  2%|▏         | 6/250 [01:00<40:18,  9.91s/it]  3%|▎         | 7/250 [01:10<40:11,  9.92s/it]  3%|▎         | 8/250 [01:20<39:54,  9.90s/it]  4%|▎         | 9/250 [01:30<39:41,  9.88s/it]  4%|▍         | 10/250 [01:39<39:27,  9.87s/it]                                                  4%|▍         | 10/250 [01:39<39:27,  9.87s/it]  4%|▍         | 11/250 [01:49<39:17,  9.86s/it]  5%|▍         | 12/250 [01:59<39:03,  9.85s/it]  5%|▌         | 13/250 [02:09<38:51,  9.84s/it]  6%|▌         | 14/250 [02:19<38:39,  9.83s/it]  6%|▌         | 15/250 [02:28<38:27,  9.82s/it]  6%|▋         | 16/250 [02:38<38:20,  9.83s/it]  7%|▋         | 17/250 [02:48<38:16,  9.86s/it]  7%|▋         | 18/250 [02:58<38:02,  9.84s/it]  8%|▊         | 19/250 [03:08<37:49,  9.83s/it]  8%|▊         | 20/250 [03:18<37:40,  9.83s/it]                                                  8%|▊         | 20/250 [03:18<37:40,  9.83s/it]  8%|▊         | 21/250 [03:27<37:28,  9.82s/it]  9%|▉         | 22/250 [03:37<37:16,  9.81s/it]  9%|▉         | 23/250 [03:47<37:08,  9.81s/it] 10%|▉         | 24/250 [03:57<36:59,  9.82s/it] 10%|█         | 25/250 [04:07<36:47,  9.81s/it] 10%|█         | 26/250 [04:16<36:35,  9.80s/it] 11%|█         | 27/250 [04:26<36:23,  9.79s/it] 11%|█         | 28/250 [04:36<36:16,  9.80s/it] 12%|█▏        | 29/250 [04:46<36:06,  9.80s/it] 12%|█▏        | 30/250 [04:56<35:56,  9.80s/it]                                                 12%|█▏        | 30/250 [04:56<35:56,  9.80s/it] 12%|█▏        | 31/250 [05:06<35:52,  9.83s/it] 13%|█▎        | 32/250 [05:15<35:40,  9.82s/it] 13%|█▎        | 33/250 [05:25<35:29,  9.81s/it] 14%|█▎        | 34/250 [05:35<35:17,  9.81s/it] 14%|█▍        | 35/250 [05:45<35:06,  9.80s/it] 14%|█▍        | 36/250 [05:55<34:56,  9.79s/it] 15%|█▍        | 37/250 [06:04<34:45,  9.79s/it] 15%|█▌        | 38/250 [06:14<34:34,  9.78s/it] 16%|█▌        | 39/250 [06:24<34:24,  9.78s/it] 16%|█▌        | 40/250 [06:34<34:16,  9.79s/it]                                                 16%|█▌        | 40/250 [06:34<34:16,  9.79s/it] 16%|█▋        | 41/250 [06:43<34:06,  9.79s/it] 17%|█▋        | 42/250 [06:53<33:56,  9.79s/it] 17%|█▋        | 43/250 [07:03<33:46,  9.79s/it] 18%|█▊        | 44/250 [07:13<33:37,  9.80s/it] 18%|█▊        | 45/250 [07:23<33:27,  9.79s/it] 18%|█▊        | 46/250 [07:32<33:15,  9.78s/it] 19%|█▉        | 47/250 [07:42<33:03,  9.77s/it] 19%|█▉        | 48/250 [07:52<32:55,  9.78s/it] 20%|█▉        | 49/250 [08:02<32:45,  9.78s/it] 20%|██        | 50/250 [08:11<32:34,  9.77s/it]                                                 20%|██        | 50/250 [08:11<32:34,  9.77s/it] 20%|██        | 51/250 [08:21<32:23,  9.77s/it] 21%|██        | 52/250 [08:31<32:13,  9.76s/it] 21%|██        | 53/250 [08:41<32:04,  9.77s/it] 22%|██▏       | 54/250 [08:51<31:53,  9.76s/it] 22%|██▏       | 55/250 [09:00<31:42,  9.76s/it] 22%|██▏       | 56/250 [09:10<31:35,  9.77s/it] 23%|██▎       | 57/250 [09:20<31:25,  9.77s/it] 23%|██▎       | 58/250 [09:30<31:23,  9.81s/it] 24%|██▎       | 59/250 [09:40<31:13,  9.81s/it] 24%|██▍       | 60/250 [09:49<31:02,  9.80s/it]                                                 24%|██▍       | 60/250 [09:49<31:02,  9.80s/it] 24%|██▍       | 61/250 [09:59<30:51,  9.80s/it] 25%|██▍       | 62/250 [10:09<30:44,  9.81s/it] 25%|██▌       | 63/250 [10:19<30:35,  9.82s/it] 26%|██▌       | 64/250 [10:29<30:23,  9.80s/it] 26%|██▌       | 65/250 [10:38<30:12,  9.79s/it] 26%|██▋       | 66/250 [10:48<30:00,  9.78s/it] 27%|██▋       | 67/250 [10:58<29:48,  9.77s/it] 27%|██▋       | 68/250 [11:08<29:42,  9.79s/it] 28%|██▊       | 69/250 [11:18<29:35,  9.81s/it] 28%|██▊       | 70/250 [11:27<29:22,  9.79s/it]                                                 28%|██▊       | 70/250 [11:27<29:22,  9.79s/it] 28%|██▊       | 71/250 [11:37<29:10,  9.78s/it] 29%|██▉       | 72/250 [11:47<29:06,  9.81s/it] 29%|██▉       | 73/250 [11:57<28:53,  9.79s/it] 30%|██▉       | 74/250 [12:06<28:41,  9.78s/it] 30%|███       | 75/250 [12:16<28:29,  9.77s/it] 30%|███       | 76/250 [12:26<28:19,  9.77s/it] 31%|███       | 77/250 [12:36<28:08,  9.76s/it] 31%|███       | 78/250 [12:45<27:59,  9.76s/it] 32%|███▏      | 79/250 [12:55<27:50,  9.77s/it] 32%|███▏      | 80/250 [13:05<27:39,  9.76s/it]                                                 32%|███▏      | 80/250 [13:05<27:39,  9.76s/it] 32%|███▏      | 81/250 [13:15<27:30,  9.77s/it] 33%|███▎      | 82/250 [13:25<27:21,  9.77s/it] 33%|███▎      | 83/250 [13:34<27:14,  9.79s/it] 34%|███▎      | 84/250 [13:44<27:04,  9.78s/it] 34%|███▍      | 85/250 [13:54<26:52,  9.77s/it] 34%|███▍      | 86/250 [14:04<26:41,  9.77s/it] 35%|███▍      | 87/250 [14:13<26:31,  9.76s/it] 35%|███▌      | 88/250 [14:23<26:19,  9.75s/it] 36%|███▌      | 89/250 [14:33<26:08,  9.74s/it] 36%|███▌      | 90/250 [14:43<25:58,  9.74s/it]                                                 36%|███▌      | 90/250 [14:43<25:58,  9.74s/it] 36%|███▋      | 91/250 [14:52<25:48,  9.74s/it] 37%|███▋      | 92/250 [15:02<25:38,  9.73s/it] 37%|███▋      | 93/250 [15:12<25:31,  9.75s/it] 38%|███▊      | 94/250 [15:22<25:23,  9.77s/it] 38%|███▊      | 95/250 [15:31<25:15,  9.78s/it] 38%|███▊      | 96/250 [15:41<25:05,  9.77s/it] 39%|███▉      | 97/250 [15:51<24:54,  9.77s/it] 39%|███▉      | 98/250 [16:01<24:44,  9.76s/it] 40%|███▉      | 99/250 [16:11<24:37,  9.79s/it] 40%|████      | 100/250 [16:20<24:24,  9.77s/it]                                                  40%|████      | 100/250 [16:20<24:24,  9.77s/it] 40%|████      | 101/250 [16:30<24:13,  9.76s/it] 41%|████      | 102/250 [16:40<24:04,  9.76s/it] 41%|████      | 103/250 [16:50<23:54,  9.76s/it] 42%|████▏     | 104/250 [16:59<23:43,  9.75s/it] 42%|████▏     | 105/250 [17:09<23:32,  9.74s/it] 42%|████▏     | 106/250 [17:19<23:22,  9.74s/it] 43%|████▎     | 107/250 [17:28<23:12,  9.74s/it] 43%|████▎     | 108/250 [17:38<23:02,  9.74s/it] 44%|████▎     | 109/250 [17:48<22:52,  9.73s/it] 44%|████▍     | 110/250 [17:58<22:42,  9.74s/it]                                                  44%|████▍     | 110/250 [17:58<22:42,  9.74s/it] 44%|████▍     | 111/250 [18:07<22:32,  9.73s/it] 45%|████▍     | 112/250 [18:17<22:27,  9.76s/it] 45%|████▌     | 113/250 [18:27<22:16,  9.76s/it] 46%|████▌     | 114/250 [18:37<22:07,  9.76s/it] 46%|████▌     | 115/250 [18:46<21:58,  9.76s/it] 46%|████▋     | 116/250 [18:56<21:48,  9.77s/it] 47%|████▋     | 117/250 [19:06<21:40,  9.78s/it] 47%|████▋     | 118/250 [19:16<21:31,  9.79s/it] 48%|████▊     | 119/250 [19:26<21:21,  9.78s/it] 48%|████▊     | 120/250 [19:35<21:09,  9.77s/it]                                                  48%|████▊     | 120/250 [19:35<21:09,  9.77s/it] 48%|████▊     | 121/250 [19:45<20:58,  9.76s/it] 49%|████▉     | 122/250 [19:55<20:47,  9.75s/it] 49%|████▉     | 123/250 [20:05<20:37,  9.75s/it] 50%|████▉     | 124/250 [20:14<20:27,  9.74s/it] 50%|█████     | 125/250 [20:24<20:17,  9.74s/it] 50%|█████     | 126/250 [20:34<20:08,  9.74s/it] 51%|█████     | 127/250 [20:44<19:58,  9.74s/it] 51%|█████     | 128/250 [20:53<19:48,  9.74s/it] 52%|█████▏    | 129/250 [21:03<19:39,  9.75s/it] 52%|█████▏    | 130/250 [21:13<19:32,  9.77s/it]                                                  52%|█████▏    | 130/250 [21:13<19:32,  9.77s/it] 52%|█████▏    | 131/250 [21:23<19:24,  9.79s/it] 53%|█████▎    | 132/250 [21:32<19:15,  9.79s/it] 53%|█████▎    | 133/250 [21:42<19:04,  9.78s/it] 54%|█████▎    | 134/250 [21:52<18:53,  9.77s/it] 54%|█████▍    | 135/250 [22:02<18:42,  9.76s/it] 54%|█████▍    | 136/250 [22:11<18:31,  9.75s/it] 55%|█████▍    | 137/250 [22:21<18:22,  9.76s/it] 55%|█████▌    | 138/250 [22:31<18:12,  9.75s/it] 56%|█████▌    | 139/250 [22:41<18:04,  9.77s/it] 56%|█████▌    | 140/250 [22:51<17:53,  9.76s/it]                                                  56%|█████▌    | 140/250 [22:51<17:53,  9.76s/it] 56%|█████▋    | 141/250 [23:00<17:44,  9.76s/it] 57%|█████▋    | 142/250 [23:10<17:33,  9.76s/it] 57%|█████▋    | 143/250 [23:20<17:24,  9.76s/it] 58%|█████▊    | 144/250 [23:30<17:16,  9.77s/it] 58%|█████▊    | 145/250 [23:39<17:05,  9.77s/it] 58%|█████▊    | 146/250 [23:49<16:56,  9.78s/it] 59%|█████▉    | 147/250 [23:59<16:48,  9.79s/it] 59%|█████▉    | 148/250 [24:09<16:37,  9.78s/it] 60%|█████▉    | 149/250 [24:19<16:29,  9.79s/it] 60%|██████    | 150/250 [24:28<16:17,  9.78s/it]                                                  60%|██████    | 150/250 [24:28<16:17,  9.78s/it] 60%|██████    | 151/250 [24:38<16:07,  9.77s/it] 61%|██████    | 152/250 [24:48<15:56,  9.76s/it] 61%|██████    | 153/250 [24:58<15:48,  9.78s/it] 62%|██████▏   | 154/250 [25:07<15:37,  9.77s/it] 62%|██████▏   | 155/250 [25:17<15:26,  9.76s/it] 62%|██████▏   | 156/250 [25:27<15:18,  9.77s/it] 63%|██████▎   | 157/250 [25:37<15:10,  9.79s/it] 63%|██████▎   | 158/250 [25:46<15:00,  9.79s/it] 64%|██████▎   | 159/250 [25:56<14:51,  9.80s/it] 64%|██████▍   | 160/250 [26:06<14:40,  9.79s/it]                                                  64%|██████▍   | 160/250 [26:06<14:40,  9.79s/it] 64%|██████▍   | 161/250 [26:16<14:29,  9.77s/it] 65%|██████▍   | 162/250 [26:26<14:18,  9.76s/it] 65%|██████▌   | 163/250 [26:35<14:08,  9.75s/it] 66%|██████▌   | 164/250 [26:45<13:58,  9.74s/it] 66%|██████▌   | 165/250 [26:55<13:48,  9.74s/it] 66%|██████▋   | 166/250 [27:05<13:39,  9.75s/it] 67%|██████▋   | 167/250 [27:14<13:28,  9.75s/it] 67%|██████▋   | 168/250 [27:24<13:18,  9.74s/it] 68%|██████▊   | 169/250 [27:34<13:08,  9.73s/it] 68%|██████▊   | 170/250 [27:43<12:58,  9.74s/it]                                                  68%|██████▊   | 170/250 [27:43<12:58,  9.74s/it] 68%|██████▊   | 171/250 [27:53<12:49,  9.74s/it] 69%|██████▉   | 172/250 [28:03<12:39,  9.74s/it] 69%|██████▉   | 173/250 [28:13<12:30,  9.75s/it] 70%|██████▉   | 174/250 [28:23<12:23,  9.78s/it] 70%|███████   | 175/250 [28:32<12:13,  9.78s/it] 70%|███████   | 176/250 [28:42<12:03,  9.77s/it] 71%|███████   | 177/250 [28:52<11:54,  9.78s/it] 71%|███████   | 178/250 [29:02<11:43,  9.77s/it] 72%|███████▏  | 179/250 [29:11<11:33,  9.76s/it] 72%|███████▏  | 180/250 [29:21<11:24,  9.78s/it]                                                  72%|███████▏  | 180/250 [29:21<11:24,  9.78s/it] 72%|███████▏  | 181/250 [29:31<11:13,  9.76s/it] 73%|███████▎  | 182/250 [29:41<11:03,  9.76s/it] 73%|███████▎  | 183/250 [29:50<10:53,  9.75s/it] 74%|███████▎  | 184/250 [30:00<10:43,  9.75s/it] 74%|███████▍  | 185/250 [30:10<10:34,  9.76s/it] 74%|███████▍  | 186/250 [30:20<10:24,  9.76s/it] 75%|███████▍  | 187/250 [30:29<10:14,  9.75s/it] 75%|███████▌  | 188/250 [30:39<10:04,  9.74s/it] 76%|███████▌  | 189/250 [30:49<09:53,  9.74s/it] 76%|███████▌  | 190/250 [30:59<09:44,  9.75s/it]                                                  76%|███████▌  | 190/250 [30:59<09:44,  9.75s/it] 76%|███████▋  | 191/250 [31:08<09:34,  9.74s/it] 77%|███████▋  | 192/250 [31:18<09:25,  9.74s/it] 77%|███████▋  | 193/250 [31:28<09:14,  9.73s/it] 78%|███████▊  | 194/250 [31:38<09:06,  9.76s/it] 78%|███████▊  | 195/250 [31:47<08:56,  9.75s/it] 78%|███████▊  | 196/250 [31:57<08:46,  9.75s/it] 79%|███████▉  | 197/250 [32:07<08:36,  9.74s/it] 79%|███████▉  | 198/250 [32:17<08:27,  9.76s/it] 80%|███████▉  | 199/250 [32:26<08:17,  9.76s/it] 80%|████████  | 200/250 [32:36<08:08,  9.77s/it]                                                  80%|████████  | 200/250 [32:36<08:08,  9.77s/it] 80%|████████  | 201/250 [32:46<07:59,  9.79s/it] 81%|████████  | 202/250 [32:56<07:48,  9.77s/it] 81%|████████  | 203/250 [33:05<07:38,  9.76s/it] 82%|████████▏ | 204/250 [33:15<07:28,  9.75s/it] 82%|████████▏ | 205/250 [33:25<07:18,  9.75s/it] 82%|████████▏ | 206/250 [33:35<07:08,  9.75s/it] 83%|████████▎ | 207/250 [33:44<06:59,  9.75s/it] 83%|████████▎ | 208/250 [33:54<06:49,  9.74s/it] 84%|████████▎ | 209/250 [34:04<06:39,  9.75s/it] 84%|████████▍ | 210/250 [34:14<06:30,  9.75s/it]                                                  84%|████████▍ | 210/250 [34:14<06:30,  9.75s/it] 84%|████████▍ | 211/250 [34:23<06:19,  9.74s/it] 85%|████████▍ | 212/250 [34:33<06:10,  9.74s/it] 85%|████████▌ | 213/250 [34:43<06:00,  9.74s/it] 86%|████████▌ | 214/250 [34:53<05:50,  9.75s/it] 86%|████████▌ | 215/250 [35:02<05:40,  9.74s/it] 86%|████████▋ | 216/250 [35:12<05:31,  9.74s/it] 87%|████████▋ | 217/250 [35:22<05:21,  9.74s/it] 87%|████████▋ | 218/250 [35:32<05:11,  9.74s/it] 88%|████████▊ | 219/250 [35:41<05:01,  9.74s/it] 88%|████████▊ | 220/250 [35:51<04:51,  9.73s/it]                                                  88%|████████▊ | 220/250 [35:51<04:51,  9.73s/it] 88%|████████▊ | 221/250 [36:01<04:43,  9.76s/it] 89%|████████▉ | 222/250 [36:11<04:33,  9.78s/it] 89%|████████▉ | 223/250 [36:20<04:24,  9.78s/it] 90%|████████▉ | 224/250 [36:30<04:14,  9.78s/it] 90%|█████████ | 225/250 [36:40<04:04,  9.76s/it] 90%|█████████ | 226/250 [36:50<03:54,  9.76s/it] 91%|█████████ | 227/250 [36:59<03:44,  9.76s/it] 91%|█████████ | 228/250 [37:09<03:34,  9.76s/it] 92%|█████████▏| 229/250 [37:19<03:24,  9.75s/it] 92%|█████████▏| 230/250 [37:29<03:14,  9.74s/it]                                                  92%|█████████▏| 230/250 [37:29<03:14,  9.74s/it] 92%|█████████▏| 231/250 [37:38<03:05,  9.74s/it] 93%|█████████▎| 232/250 [37:48<02:55,  9.74s/it] 93%|█████████▎| 233/250 [37:58<02:45,  9.74s/it] 94%|█████████▎| 234/250 [38:08<02:35,  9.74s/it] 94%|█████████▍| 235/250 [38:18<02:26,  9.79s/it] 94%|█████████▍| 236/250 [38:27<02:16,  9.77s/it] 95%|█████████▍| 237/250 [38:37<02:06,  9.75s/it] 95%|█████████▌| 238/250 [38:47<01:57,  9.75s/it] 96%|█████████▌| 239/250 [38:56<01:47,  9.74s/it] 96%|█████████▌| 240/250 [39:06<01:37,  9.75s/it]                                                  96%|█████████▌| 240/250 [39:06<01:37,  9.75s/it] 96%|█████████▋| 241/250 [39:16<01:27,  9.74s/it] 97%|█████████▋| 242/250 [39:26<01:17,  9.74s/it] 97%|█████████▋| 243/250 [39:35<01:08,  9.74s/it] 98%|█████████▊| 244/250 [39:45<00:58,  9.74s/it] 98%|█████████▊| 245/250 [39:55<00:48,  9.73s/it] 98%|█████████▊| 246/250 [40:05<00:39,  9.75s/it] 99%|█████████▉| 247/250 [40:14<00:29,  9.74s/it] 99%|█████████▉| 248/250 [40:24<00:19,  9.74s/it]100%|█████████▉| 249/250 [40:34<00:09,  9.74s/it]100%|██████████| 250/250 [40:44<00:00,  9.74s/it]                                                 100%|██████████| 250/250 [40:44<00:00,  9.74s/it]                                                 100%|██████████| 250/250 [40:45<00:00,  9.74s/it]100%|██████████| 250/250 [40:45<00:00,  9.78s/it]
